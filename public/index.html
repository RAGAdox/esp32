<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <link rel="icon" href="/docs/4.0/assets/img/favicons/favicon.ico" />

    <title>Fixed top navbar example for Bootstrap</title>

    <link
      rel="canonical"
      href="https://getbootstrap.com/docs/4.0/examples/navbar-fixed/"
    />

    <!-- Bootstrap core CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="style.css" />
  </head>

  <body onLoad="onLoad()">
    <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark px-3">
      <a class="navbar-brand" href="#">ESP 32</a>
      <button
        class="navbar-toggler"
        type="button"
        data-toggle="collapse"
        data-target="#navbarCollapse"
        aria-controls="navbarCollapse"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarCollapse">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item active">
            <a class="nav-link" href="#">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">About</a>
          </li>
        </ul>
      </div>
    </nav>

    <main role="main" class="container">
      <div class="jumbotron">
        <div
          class="
            vh-100
            d-flex
            justify-content-center
            align-items-center
            flex-column
          "
        >
          <button id="led1" onclick="handleClick(this.id)" class="btn m-2">
            Toggle LED 1
          </button>
          <button id="led2" onclick="handleClick(this.id)" class="btn m-2">
            Toggle LED 2
          </button>
        </div>
      </div>
    </main>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/javascript">
      const onLoad = async () => {
        const result = await fetch(`/api/status`, { method: "GET" })
          .then((response) => {
            console.log(response.status);
            return response.status === 200 ? response.text() : "error";
          })
          .catch((error) => {
            return "error";
          });
        let status = result.split(",");
        console.log(status);
        if (status[0] === "true") {
          document.getElementById("led1").classList.add("btn-warning");
        } else {
          document.getElementById("led1").classList.add("btn-secondary");
        }
        if (status[1] === "true") {
          document.getElementById("led2").classList.add("btn-warning");
        } else {
          document.getElementById("led2").classList.add("btn-secondary");
        }
      };
      const handleClick = async (id) => {
        const result = await fetch(`/api/${id}`, { method: "GET" })
          .then((response) => {
            console.log(response.status);
            return response.status === 200 ? response.text() : "error";
          })
          .catch((error) => {
            return "error";
          });

        console.log(result);
        if (document.getElementById(id).classList.contains("btn-warning"))
          document
            .getElementById(id)
            .classList.replace("btn-warning", "btn-secondary");
        else if (
          document.getElementById(id).classList.contains("btn-secondary")
        )
          document
            .getElementById(id)
            .classList.replace("btn-secondary", "btn-warning");
      };
    </script>
  </body>
</html>
